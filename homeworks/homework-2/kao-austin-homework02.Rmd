---
title: "Homework 2"
author: "STA 360, Fall 2020"
date: "Due Friday August 28, 5 PM EDT"
output: pdf_document
---

# Lab component
## Task 1

Let's start by quickly deriving the Beta-Binomial distribution. 

We assume that 
$$X\mid \theta \sim \text{Binomial} (\theta)$$,
$$\theta \sim \text{Beta}(a,b),$$
where $a,b$ are assumed to be known parameters. What is the posterior distribution of $\theta \mid X$?

\begin{align}
p(\theta \mid X) &\propto 
p(X \mid \theta) p(\theta) \\
&\propto \theta^{x} 
(1 - \theta)^{(n-x)} \times \theta^{(a-1)} (1 - \theta)^{(b-1)}\\
&\propto \theta^{x + a -1} (1 - \theta)^{(n-x + b -1)}.
\end{align}

This implies that 
$$\theta \mid X \sim \text{Beta}(x+a,n-x+b).$$



## Task 2

Simulate some data using the \textsf{rbinom} function of size $n = 100$ and probability equal to 1\%. Remember to \textsf{set.seed(123)} so that you can replicate your results.

The data can be simulated as follows:
```{r,echo=TRUE}
# set a seed
set.seed(123)
# create the observed data
obs.data <- rbinom(n = 100, size = 1, prob = 0.01)
# inspect the observed data
head(obs.data)
tail(obs.data)
length(obs.data)
```

## Task 3

Write a function that takes as its inputs that data you simulated (or any data of the same type) and a sequence of $\theta$ values of length 1000 and produces Likelihood values based on the Binomial Likelihood. Plot your sequence and its corresponding Likelihood function.

The likelihood function is given below. Since this is a probability and is only valid over the interval from $[0, 1]$ we generate a sequence over that interval of length 1000.

You have a rough sketch of what you should do for this part of the assignment. Try this out in lab on your own. 

```{r, echo = TRUE}
### Bernoulli LH Function ###
# Input: obs.data, theta
# Output: bernoulli likelihood


### Plot LH for a grid of theta values ###
# Create the grid #
# Store the LH values
# Create the Plot
```

## Task 4

## Task 5



# Exponential Gamma Model
a.
\begin{align*}
p(x_{1:n}|\theta) &= \theta^n e^{-n\theta \sum_{i=1}^{n} x_i} I(x>0)\\
p(\theta|x_{1:n}) &= \frac{p(x_{1:n}|\theta)p(\theta)}{p(x)}\\
p(\theta|x_{1:n}) &\propto \theta^n e^{(-n\theta \sum_{i=1}^{n} x_i)} \frac{b^a}{\Gamma(a)} \theta^{a-1} e^{-b\theta} I(x > 0)\\
p(\theta|x_{1:n}) &\propto \theta^{n+a-1} e^{(-b\theta-n\theta \sum_{i=1}^{n} x_i)} I(x > 0)\\
p(\theta|x_{1:n}) &\propto \theta^{n+a-1} e^{-(b+n \sum_{i=1}^{n} x_i) \theta} I(x > 0)\\
\end{align*}
As can be seen above: $$p(\theta|x_{1:n}) \sim \text{Gamma}(\theta | n+a,b+n\sum_{i=1}^{n} x_i)$$

b. The posterior distribution is a proper probability distribution function because the likelihood and prior functions are too.

c.
```{r}
x <- c(20.9, 69.7, 3.6, 21.8, 21.4, 0.4, 6.7, 10.0)
```

d. An Exponential model would be reasonable when modeling the time it takes in between the arrival of .

# Priors, Posteriors, Predictive Distributions
a. A class of conjugate prior densities for $\theta$ are Gamma distributions.
[Plot here]

b.

